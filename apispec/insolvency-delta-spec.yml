post:
  summary: Accepts an incoming insolvency delta, transforms it into an avro schema and puts it onto a Kafka topic.
  requestBody:
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/Insolvency'
    required: true
  responses:
    "200":
      description: Successfully produced message onto Kafka topic.
    "400":
      description: Bad request body - validation errors.
    "401":
      description: Unauthorised - missing api key in header.
    "500":
      description: Internal server error has occured.
components:
  schemas:
    Insolvency:
      required:
      - company_number
      - case_numbers
      type: object
      properties:
        title:
          type: string
          enum: ['insolvency']
        company_number:
          maxLength: 10
          type: string
        case_numbers:
          type: array
          items:
            $ref: '#/components/schemas/Case-number'
    Case-number:
      required:
      - case_number
      - case_type_id
      - case_type
      type: object
      properties:
        case_number:
          type: integer
        case_type_id:
          type: integer
          enum:
          - 1
          - 2
          - 3
          - 5
          - 6
          - 7
          - 8
          - 13
          - 14
          - 15
          - 17
        case_type:
          type: string
          enum: ['Members Voluntary Liquidation',
                'Creditors Voluntary Liquidation',
                'Compulsory Liquidation',
                'Receiver/Manager',
                'Administrative Receiver',
                'Administration',
                'Corporate Voluntary Arrangement',
                'In Administration',
                'CVA Moratorium',
                'Foreign Insolvency',
                'Moratorium']
        mortgage_id:
          type: integer
        appointments:
          type: array
          items:
            $ref: '#/components/schemas/Appointment'
        wind_up_date:
          type: string
        dissolved_date:
          type: string
        dissolved_due_date:
          type: string
        sworn_date:
          type: string
        petition_date:
          type: string
        wind_up_conclusion_date:
          type: string 
        instrument_date:
          type: string
        admin_order_date:
          type: string
        discharge_admin_order_date:
          type: string
        report_date:
          type: string
        completion_date:
          type: string
        admin_start_date:
          type: string
        admin_end_date:
          type: string
        appointment_date:
          type: string
        end_date:
          type: string

    Appointment:
      type: object
      properties:
        forename:
          type: string
          maxLength: 50
        middle_name:
          type: string
          maxLength: 50
        surname:
          type: string
          maxLength: 160
        appt_type:
          type: integer
          enum:
          - 1
          - 2
          - 3
          - 4
          - 5
          - 6
          - 7
          - 8
        appt_date:
          type: string
        ceased_to_act_appt:
          type: string
        practitioner_address:
          $ref: '#/components/schemas/Practitioner-address'
    Practitioner-address:
      type: object
      properties:
        address_line_1:
          type: string
          maxLength: 50
        address_line_2:
          type: string
          maxLength: 50
        locality:
          type: string
          maxLength: 50
        region:
          type: string
          maxLength: 50
        country:
          type: string
          maxLength: 50
        postal_code:
          type: string
          maxLength: 20